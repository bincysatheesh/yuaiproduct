{% extends 'admin/adminbase.html' %}
{% load static %}
{% block content %}   
<style>   table {
  width: 100%; /* Set the width of the table to 100% */
}
th,td{
  padding: 5px;
}
.customers .card-body .table-responsive {
  max-width: 100%; /* Set your desired maximum width */
  overflow-x: auto; /* Add horizontal scroll if needed */
}
.customers .card-body {
  max-width: 350px; /* Set the maximum width for the Enquiries section */
}


/* Add this style for the hover effect */
table tbody tr:hover {
  background-color: #f5f5f5;
}

/* Style for the link container */
.link-container {
  display: inline-block;
  padding: 1px 2px;
  background-color: #3d6a95;
  color: #fff;
  text-decoration: none;
  border-radius: 4px;
  transition: background-color 0.3s;
}

.link-container:hover {
  background-color: #2b3348;
}

.recent-grid {
  margin-top: 3.5rem;
  display: grid;
  grid-gap: 2rem; /* Adjust the gap between the two grids */
  grid-template-columns: 75% auto; /* Adjust the width of each grid */
}


/* ----------------------button style */

/* Style for the delete button */
/* Style for the delete button */
.delete-button {
  background-color: transparent;
  border: none;
  cursor: pointer;
  width: auto; /* Set width to auto to match the width of the content */
  height: auto; /* Set height to auto to match the height of the content */
  padding: 0; /* Remove padding to make the button size match the content */
  color: #3d6a95;
}

.delete-button i {
  width: 100%; /* Set the width of the icon to 100% */
  height: 100%; /* Set the height of the icon to 100% */
}

.delete-button:hover {
  color: #cd0c0c; /* Change color on hover */
}
/* Style for the button spacing */
.button-spacing {
  margin-right: 10px; /* Adjust the margin to add appropriate spacing */
}
.approve-button {
    background-color: #007bff; /* Blue color */
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 4px;
    transition: transform 0.2s; /* Add transition for smooth hover effect */
}

/* Hover effect */
.approve-button:hover {
    transform: scale(1.1); /* Increase button size on hover */
    background-color: #3d6a95;
}
.uppercase-text {
            text-transform: uppercase;
            font-weight: bold;
        }


        .block-button {
    height: 1.5rem; /* Adjust the height as needed */
    min-width: 6rem; /* Set minimum width to accommodate the content */
    background-color: #3d6a95;
    border: none;
    color: #fff;
    padding: 0 1rem; /* Adjust padding for better appearance */
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-size: 1rem; /* Set font size for better readability */
  }

  .block-button:hover {
    background-color: #2b3348;
  }

  /* Additional styles for responsiveness */
  @media screen and (max-width: 768px) {
    .block-button {
      width: 100%; /* Make the button fill the available width */
      margin-bottom: 0.5rem; /* Add space between buttons on smaller screens */
    }
  }
/* Style for all buttons */
.approve-button,
.block-button,
.delete-button,
.link-container1 {
    height: 40px; /* Set the height for all buttons */
    min-width: 100px; /* Set the minimum width for all buttons */
    display: inline-flex; /* Ensure inline display to adjust width */
    align-items: center; /* Align content vertically */
    justify-content: center; /* Align content horizontally */
    text-align: center; /* Align text horizontally */
    padding: 0 15px; /* Adjust padding as needed */
    font-size: 14px; /* Adjust font size as needed */
    border-radius: 4px; /* Add border radius */
    cursor: pointer; /* Change cursor to pointer on hover */
    transition: background-color 0.3s, transform 0.2s; /* Add transitions for hover effects */
}

/* Hover effect for all buttons */
.approve-button:hover,
.block-button:hover,
.delete-button:hover,
.link-container1:hover {
    transform: scale(1.1); /* Increase button size on hover */
}

/* Adjust the spacing between buttons if needed */
.button-spacing {
    margin-right: 10px; /* Adjust the margin to add appropriate spacing */
}
.las.la-eye {
    font-size: 24px; /* Adjust the font size */
    font-weight: bold; /* Make the icon bold */
}
.las.la-eye:hover{
    transform: scale(1.1); 
}
/* Style for the trash icon */
.fa-trash {
    color: #f1aa04; /* Set default color */
    font-size: 24px; /* Set default font size */
    transition: transform 0.2s, color 0.2s; /* Add transition for smooth hover effect */
}

/* Hover effect for the trash icon */
.fa-trash:hover {
    transform: scale(1.2); /* Increase size on hover */
    color: #ffcc00; /* Change color on hover */
}



</style>
    
    
    <input type="checkbox" id="nav-toggle">
    <div class="sidebar"> 
      <div class="sidebar-brand">
        <h2><span class="las la-user-circle"></span><span>ZMCA</span></h2>

      </div>
      <div class="sidebar-menu">
        <ul>
          <li>
            <a href="{% url 'adminindex' %}" class="active"><span class="fas fa-home"></span>
            <span>Home</span></a>
          </li>
          <!-- <li>
            <a href="{% url 'adminindex' %}"><span class="fas fa-home"></span>
            <span></span></a>
          </li> -->
          <li>
            <a href="{% url 'members_view' %}"><span class="las la-home"></span>
              <span>Families</span></a>
          <li>
            <a href="{% url 'committe' %}"><span class="las la-users"></span>
            <span>Committee Members</span></a>
          </li>
          <li>
            <a href="{% url 'fam_view' %}">
            <span class="fas fa-id-badge"></span>
            <span>Membership</span></a>
          </li>
          
          <li>
            <a href="{% url 'enquiry_list' %}"><span class="fas fa-envelope"></span>
            <span>Enqueries</span></a>
            <!-- <ul class="submenu">
              <li></li>
              <li><a href="{% url 'allenquiry_list' %}"><span class="fas fa-envelope"></span><span>(All)</span></a></li>            
           -->
           </ul>
          </li>
          <li>
            <a href="{% url 'bloodgroupadmin' %}">
              <span class="fas fa-tint" style="color: red;"></span>
            <span>Blood Group</span></a>
          </li>
          <li>
            <a href="{% url 'birthdaydetails1' %}">
              <span class="fas fa-birthday-cake"></span>
            <span>Birthday</span></a>
          </li>

          </li>
          <li>
            <a href="{% url 'addgalleryview' %}"><span class="fa-solid fa-image"></span>
            <span>Gallery</span></a>
            <ul class="submenu">
              <!-- <li></li>
              <li><a href="{% url 'addgalleryview' %}"><span class="fa-solid fa-images" style="color: #f1f2f3;"></span>

                Add Gallery</a></li>
              <li><a href="{% url 'galleryview' %}"><span class="fa-solid fa-images" style="color: #f1f2f3;"></span>

                Gallery</a></li> -->
         
          
           </ul>
           <li>
            <a href="{% url 'addhomegallery' %}"><span class="fa-solid fa-image"></span>
            <span>Home Gallery</span></a>
           
              </ul>
          </li>
          <!-- <li>
            <a href="{% url 'gallery'%}"><span class="fa-solid fa-image"></span>
            <span>Gallery</span></a>
          </li> -->
          <li>
            <a href="{% url 'addblogview' %}"><span class="las la-blog"></span>
            <span>Blog</span></a>
          </li>
          <li>
            <a href="{% url 'eventview' %}"><span class="fa fa-bell"></span>
            <span>Events</span></a>
          </li>
        </ul>
      </div>
    </div>
    <!-- --------end link---------- -->
    <div class="main-content">
      <header>
           
        <h2> 
          <label for="nav-toggle">
            <span class="las la-bars"></span>
          </label>       
        ZMCA Admin
        </h2>

 
         
<div class="search-wrapper">
  <form id="search-form" method="GET" action="{% url 'fam_view' %}">
      <span class="las la-search"></span>
      <input id="search-input" type="search" name="q" placeholder="Search here" value="{{ request.GET.q }}"/>
  </form>
</div>

        <div class="user-wrapper">
          <img src="{% static 'img/logo.jpg' %}" width="60px" height="60px" alt="">
        
          <div>
            <!-- <h4>ZMCA</h4> -->
            <h4>        <a href="{% url 'logout' %}" style="font-size: 16px;"> <i class="fa-solid fa-right-from-bracket"></i></a>
            </h4>
            <small>Super Admin</small>

          </div>

          
        </div>

      </header>
      <!-- ----------end header---------- -->
      <main>
        
        

        <!-- -------------------endcards------------- -->
<div class="recent-grid">
  <div class="projects" >
    <div class="card" style="width: 133%;">
      <div class="card-header">
        <h2><span class="las la-users" style="color: #3d6a95;"></span>
            <span class="uppercase-text">Membership</span></h2> 

            
        <button><a href="{% url 'memberships' %}" style="color: #fff;">Set Membership Amount<span class="las la-arrow-right"></span></a></button>

      </div>
      <div class="card-body">

        <!-- --------------begincardbody-------- -->
        {% if members_info %}
        <div class="table-responsive">
            <table width="100%">
                <thead  style="background-color:#3d6a95;">
                    <tr> <td style="color: #fff;" class="uppercase-text">Id</td>
                        <td  style="color: #fff;" class="uppercase-text">Member Name</td>
                       
                        <td style="color: #fff;" class="uppercase-text">Family Name</td>
                        <td style="color: #fff;" class="uppercase-text">Email</td>
                        <!-- <td style="color: #fff;" class="uppercase-text">Contact Number</td> -->
                        <td style="color: #fff;" class="uppercase-text">STATUS</td>
                        <td style="color: #fff;" class="uppercase-text">Paynow</td>
                        <td style="color: #fff;" class="uppercase-text">Action</td>

                     
                    </tr>
                </thead>
                <tbody>
                    {% for member in members_info %}
                        <tr>
                          <td class="uppercase-text">{{ forloop.counter }}</td>
                            <td class="uppercase-text">{{ member.firstname }}&nbsp;&nbsp;{{ member.lastname }}&nbsp;(<span class="total">{{ member.total }}</span>)</td>
                            <td class="uppercase-text">{{ member.familyname }}</td>
                            <td style="font-weight: bold;">{{ member.email }}</td>
                            <!-- <td class="uppercase-text">{{ member.phonenumber }}</td> -->
                            <td>
                              {% if member.payment_status == 'Paid' %}
                                  <button class="approve-button" style="background-color: darkgreen;">Paid</button>
                              {% elif member.payment_status == 'Unpaid' %}
                                  <button class="approve-button" style="background-color:#cd0c0c;">Unpaid</button>
                              {% else %}
                                  <button class="approve-button" style="background-color:#cd0c0c;">Unpaid</button>
                              {% endif %}
                          </td>
                            <td>
                             <button> <a href="{% url 'paynow' user_id=member.id %}" class="block-button" > 
                                  <span></span>PAY NOW</span> 
                                  
                                  </a>
                                </button></td>
                            <td>
                              <button class="block-button" onclick="confirmBlockUser({{ member.id }}, this)">
                                <i class="fas fa-ban"></i>&nbsp; Suspend
                            </button>                           
                            
                            &nbsp;&nbsp; 
                              <a href="{% url 'payments' user_id=member.id %}" > 
                                  <span class="las la-eye" ></span> 
                                  </a>       &nbsp;&nbsp;  &nbsp;&nbsp; 
                                  <!-- <a href="{% url 'deletefamily' f_id=member.id %}" class="link-container"> 
                                    <span class="las la-trash-alt" style="height: 20px;height: 20px;"></span>
                                </a> -->
                                <form method="post" action="{% url 'deletefamily1' f_id=member.id %}">
                                  {% csrf_token %}
                                  <button type="submit" style="background-color: #fff; border: #fff;" onclick="return confirm('Are you sure you want to delete this member?')">
                                      <i class="fa-solid fa-trash" style="color: #f1aa04; font-size: 24px;"></i>
                                  </button>
                              </form>
                                
                                                         </td>
                           
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p style="text-align: center;" class="uppercase-text"><br>No search results found &nbsp;<span class="las la-smile" style="color: darkgoldenrod;"></span></p>
        {% endif %}
       <!-- -----------endcardbody------------------ -->
       <!-- -----------Paginator------------------ -->
       <!-- Display pagination links -->
<div class="pagination">
  <span class="step-links" class="uppercase-text">
      {% if members_info.has_previous %}
          <a href="?page=1" class="uppercase-text">&laquo; first</a>
          <a href="?page={{ members_info.previous_page_number }}" class="uppercase-text">previous</a>
      {% endif %}

      <span class="current" class="uppercase-text">
          Page {{ members_info.number }} of {{ members_info.paginator.num_pages }}.
      </span>

      {% if members_info.has_next %}
          <a href="?page={{ members_info.next_page_number }}" class="uppercase-text">next</a>
          <a href="?page={{ members_info.paginator.num_pages }}" class="uppercase-text">last &raquo;</a>
      {% endif %}
  </span>
</div>
       <!-- ----------------endpaginator--------------- -->
      </div>


    </div>

  </div>
<!-- -------------endof table---------------------- -->
</div>        
      </main>
    </div>

<!-- ----------------search script---------------- -->


<!-- ----------------search script---------------- -->
<script>
  // Get the search input element
  var searchInput = document.getElementById("search-input");

  // Variable to store the timeout
  var timeout = null;

  // Add an event listener to detect keypress events
  searchInput.addEventListener("keypress", function(event) {
      // Check if the Enter key was pressed
      if (event.key === 'Enter') {
          // Prevent the default form submission behavior
          event.preventDefault();
      }
  });

  // Add an event listener to detect changes in the input field
  searchInput.addEventListener("input", function() {
      // Clear the previous timeout to avoid rapid submission
      clearTimeout(timeout);

      // Set a timeout to delay form submission
      timeout = setTimeout(function() {
          // Get the search form element
          var searchForm = document.getElementById("search-form");
          
          // Submit the form
          searchForm.submit();
      }, 1000); // Adjust the delay time (in milliseconds) as needed
  });
</script>


<!-- -------------------search----------------- -->
<script>
  function confirmBlockUser(userId, button) {
      // Prompt user for confirmation
      var confirmMsg = "Are you sure you want to block this user?";
      if (confirm(confirmMsg)) {
          // If user confirms, proceed to block user
          blockUser(userId, button);
      } else {
          // If user cancels, do nothing
          return false;
      }
  }

  function blockUser(userId, button) {
      fetch(`/block_user/${userId}/`, {
          method: 'POST',
          headers: {
              'X-CSRFToken': '{{ csrf_token }}', // Ensure CSRF token is included
          },
      })
      .then(response => {
          if (response.ok) {
              // Remove the row from the table
              var row = button.closest("tr");
              row.parentNode.removeChild(row);
          } else {
              // Handle errors, if needed
          }
      })
      .catch(error => {
          console.error('Error:', error);
      });
  }
</script>

    {% endblock %}    